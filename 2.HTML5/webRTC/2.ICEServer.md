#3 穿越NAT/防火墙进行通信
这里需要使用到STUN服务器(穿越NAT，穿透网关)/TRUN服务器（穿透防火墙）。如果不指定STUN/NAT,则应用程序时不能被允许在一个使用了NAT/防火墙的网络环境。

## 3.1 穿越NAT

在宽带路由器或WiFi路由器中，可以将一个全局IP地址共享给多个PC或其他设备。NAT作用在其中的作用：<br>
1. 将链接到互联网的全局IP地址转换为家庭或公司的局域网中使用的IP地址
2. 为可以在多个PC或其他设备间同时通信，通过端口映射来进行端口转换<br>
在WebRTC中，必须穿透NAT进行通信。因为浏览器只能捕获客户端计算机中所分配的局域网中的IP地址，以及进行WebRTC通信时所使用（被动态分配）的UDP端口。并不能捕获客户端计算机在互联网中被分配的全局地址以及通过NAT来映射的面向局域网外部的UDP端口。<br>
为了执行P2P通信，必须在信令处理中互相通知互联网侧（即局域网内部）的信息。而通知浏览器互联网侧的信息的手段就是STUN.<br>

### 3.1.1 STUN概念
STUN:即通知浏览器如何查看互联网侧的信息，不仅仅作用于WrbRTC通信，而是作为一种通用的辅助UDP通信的手段。<br>
在通过信令进行WebRTC通信时，为了想互联网侧通知自己的信息，也必须通过信令服务器将这些信息发送给对方。在双方通过信令服务器彼此传递信息后，就可以通信。

### 3.2 穿越防火墙
在大多数企业中都设置了防火墙，这种情况下，对于可以与外部通信的端口也做了限制。由于STUN服务动态分配端口号，所以如果不克服防洪墙的障碍则不能进行通信。这种情况就需要使用TURN服务器。
### 3.2.1 TURN概念
使用TURN服务器进行通信时，通信双方依靠TURN服务器传来实际的数据流，在TRUN服务器中并不执行视频或音频数据的编码，所以与CPU负荷相比，网络负荷变得更高。
### 3.2.2 在防火墙开放一个端口
为使用TURN服务器，需要在防火墙中开放一个端口。TURN服务器默认使用3478端口。另外需要为信令服务器的通信开放一个端口，例如在使用9000情况下则需要开放9000端口。<br>

